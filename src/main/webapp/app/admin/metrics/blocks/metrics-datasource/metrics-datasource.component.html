<!--
  ~ Copyright (c) 2021. The Hyve
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~
  ~ See the file LICENSE in the root of this repository.
  -->

<h3 [translate]="'metrics.datasource.title'" id="datasourceMetrics">DataSource statistics (time in millisecond)</h3>

<div *ngIf="!updating && datasourceMetrics" class="table-responsive">
    <table aria-describedby="datasourceMetrics" class="table table-striped">
        <thead>
        <tr>
            <th scope="col">
                <span [translate]="'metrics.datasource.usage'">Connection Pool Usage</span>
                (active: {{ datasourceMetrics.active.value }},
                min: {{ datasourceMetrics.min.value }}, max: {{ datasourceMetrics.max.value }},
                idle: {{ datasourceMetrics.idle.value }})
            </th>
            <th [translate]="'metrics.datasource.count'" class="text-right" scope="col">Count</th>
            <th [translate]="'metrics.datasource.mean'" class="text-right" scope="col">Mean</th>
            <th [translate]="'metrics.servicesstats.table.min'" class="text-right" scope="col">Min</th>
            <th [translate]="'metrics.servicesstats.table.p50'" class="text-right" scope="col">p50</th>
            <th [translate]="'metrics.servicesstats.table.p75'" class="text-right" scope="col">p75</th>
            <th [translate]="'metrics.servicesstats.table.p95'" class="text-right" scope="col">p95</th>
            <th [translate]="'metrics.servicesstats.table.p99'" class="text-right" scope="col">p99</th>
            <th [translate]="'metrics.datasource.max'" class="text-right" scope="col">Max</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Acquire</td>
            <td class="text-right">{{ datasourceMetrics.acquire.count }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.acquire.mean) | number: '1.0-2' }}</td>
            <td class="text-right">{{ datasourceMetrics.acquire['0.0'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.acquire['0.5'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.acquire['0.75'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.acquire['0.95'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.acquire['0.99'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.acquire.max) | number: '1.0-2' }}</td>
        </tr>
        <tr>
            <td>Creation</td>
            <td class="text-right">{{ datasourceMetrics.creation.count }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.creation.mean) | number: '1.0-2' }}</td>
            <td class="text-right">{{ datasourceMetrics.creation['0.0'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.creation['0.5'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.creation['0.75'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.creation['0.95'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.creation['0.99'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.creation.max) | number: '1.0-2' }}</td>
        </tr>
        <tr>
            <td>Usage</td>
            <td class="text-right">{{ datasourceMetrics.usage.count }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.usage.mean) | number: '1.0-2' }}</td>
            <td class="text-right">{{ datasourceMetrics.usage['0.0'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.usage['0.5'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.usage['0.75'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.usage['0.95'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ datasourceMetrics.usage['0.99'] | number: '1.0-3' }}</td>
            <td class="text-right">{{ filterNaN(datasourceMetrics.usage.max) | number: '1.0-2' }}</td>
        </tr>
        </tbody>
    </table>
</div>
