<!--
  ~ Copyright (c) 2021. The Hyve
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~
  ~ See the file LICENSE in the root of this repository.
  -->

<h3 [translate]="'metrics.cache.title'" id="cacheMetrics">Cache statistics</h3>

<div *ngIf="!updating && cacheMetrics" class="table-responsive">
    <table aria-describedby="cacheMetrics" class="table table-striped">
        <thead>
        <tr>
            <th [translate]="'metrics.cache.cachename'" scope="col">Cache name</th>
            <th [translate]="'metrics.cache.hits'" class="text-right" scope="col">Cache Hits</th>
            <th [translate]="'metrics.cache.misses'" class="text-right" scope="col">Cache Misses</th>
            <th [translate]="'metrics.cache.gets'" class="text-right" scope="col">Cache Gets</th>
            <th [translate]="'metrics.cache.puts'" class="text-right" scope="col">Cache Puts</th>
            <th [translate]="'metrics.cache.removals'" class="text-right" scope="col">Cache Removals</th>
            <th [translate]="'metrics.cache.evictions'" class="text-right" scope="col">Cache Evictions</th>
            <th [translate]="'metrics.cache.hitPercent'" class="text-right" scope="col">Cache Hit %</th>
            <th [translate]="'metrics.cache.missPercent'" class="text-right" scope="col">Cache Miss %</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let entry of cacheMetrics | keyvalue">
            <td>{{ entry.key }}</td>
            <td class="text-right">{{ entry.value['cache.gets.hit'] }}</td>
            <td class="text-right">{{ entry.value['cache.gets.miss'] }}</td>
            <td class="text-right">{{ entry.value['cache.gets.hit'] + entry.value['cache.gets.miss'] }}</td>
            <td class="text-right">{{ entry.value['cache.puts'] }}</td>
            <td class="text-right">{{ entry.value['cache.removals'] }}</td>
            <td class="text-right">{{ entry.value['cache.evictions'] }}</td>
            <td class="text-right">
                {{
                    filterNaN((100 * entry.value['cache.gets.hit']) / (entry.value['cache.gets.hit'] + entry.value['cache.gets.miss']))
                            | number: '1.0-4'
                }}
            </td>
            <td class="text-right">
                {{
                    filterNaN((100 * entry.value['cache.gets.miss']) / (entry.value['cache.gets.hit'] + entry.value['cache.gets.miss']))
                            | number: '1.0-4'
                }}
            </td>
        </tr>
        </tbody>
    </table>
</div>
